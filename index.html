<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para mi San Valentín</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #ffe6e6; /* Light pink background */
            font-family: 'Arial', sans-serif;
            overflow: hidden; /* Prevent scrollbars when button moves */
            flex-direction: column;
            text-align: center;
        }

        h1 {
            color: #ff4d4d;
            font-size: 2.5rem;
            margin-bottom: 20px;
            z-index: 10;
        }

        .container {
            position: relative;
            z-index: 10;
        }

        .buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }

        button {
            padding: 15px 30px;
            font-size: 1.2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        #yesBtn {
            background-color: #ff4d4d;
            color: white;
            box-shadow: 0 4px 15px rgba(255, 77, 77, 0.4);
        }

        #yesBtn:hover {
            background-color: #e60000;
            transform: scale(1.05);
        }

        #noBtn {
            background-color: white;
            color: #ff4d4d;
            border: 2px solid #ff4d4d;
            position: relative; /* Changed to absolute in JS for movement */
            z-index: 100; /* Ensure it stays on top */
        }

        .gif-container {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .gif-container img {
            max-width: 80%;
            max-height: 60vh;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        /* Floating hearts background animation */
        .heart {
            position: absolute;
            color: #ffb3b3;
            font-size: 20px;
            animation: float 6s infinite ease-in;
            z-index: 1;
            opacity: 0;
        }

        @keyframes float {
            0% { transform: translateY(100vh) scale(0.5); opacity: 0; }
            20% { opacity: 1; }
            100% { transform: translateY(-10vh) scale(1.5); opacity: 0; }
        }

        #boundary-box {
            position: absolute;
            width: 80vw;
            height: 80vh;
            border: 3px dashed #ffb3b3;
            border-radius: 20px;
            pointer-events: none; /* Allows clicks to pass through */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-sizing: border-box;
            z-index: 5;
        }

        .main-gif {
            width: 150px;
            height: auto;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        /* Mobile Optimization */
        @media (max-width: 600px) {
            h1 {
                font-size: 1.8rem; /* Smaller text for mobile */
            }
            .main-gif {
                width: 120px; /* Smaller cat gif */
            }
            button {
                padding: 10px 20px; /* Smaller buttons */
                font-size: 1rem;
            }
            #boundary-box {
                width: 90vw; /* Wider boundary for narrow screens */
                height: 60vh; /* Shorter boundary to avoid URL bars */
            }
            .buttons {
                gap: 10px; /* Closer buttons */
            }
        }

        #top-link-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #ff9999;
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            z-index: 200;
        }

        #top-link-btn:hover {
            transform: scale(1.05);
            background-color: #ff8080;
        }
    </style>
</head>
<body>

    <!-- Floating hearts container -->
    <div id="hearts-container"></div>

    <a id="top-link-btn" href="card2.html">Siguiente Sorpresa ➡️</a>

    <!-- Movement boundary for 'No' button -->
    <div id="boundary-box"></div>

    <div class="container" id="main-content">
        <img class="main-gif" src="https://media.tenor.com/aH6qp6K6lO4AAAAj/apple-apple-cat.gif" alt="Cute Cat">
        <h1>Serías mi San Valentín mi corazón?</h1>
        <div class="buttons">
            <button id="yesBtn">Sí</button>
            <button id="noBtn">No</button>
        </div>
    </div>

    <div class="gif-container" id="success-content">
        <h1>Besitoooossss mi corazónnn jsjs ❤️</h1>
        <!-- Cute GIF placeholder (Mochi Peach Cat) -->
        <img src="https://media1.tenor.com/m/IBxdvql1Mk0AAAAC/cat-kiss.gif" alt="Cute Happy Gif">
    </div>

    <script>
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const mainContent = document.getElementById('main-content');
        const successContent = document.getElementById('success-content');
        
        let yesScale = 1;
        let noScale = 1;
        let hasShrunk = false;
        let hasGrown = false;

        // Function to move the 'No' button - Completely Rewritten
        function moveNoButton() {
            const boundary = document.getElementById('boundary-box');
            const rect = boundary.getBoundingClientRect();
            const yesRect = yesBtn.getBoundingClientRect();
            
            // Current dimensions of the No button
            // We use offsetWidth/Height for the base size
            const btnWidth = noBtn.offsetWidth;
            const btnHeight = noBtn.offsetHeight;

            // Use fixed positioning to avoid relative container confusion
            noBtn.style.position = 'fixed';

            let bestX = rect.left;
            let bestY = rect.top;
            let foundSafeSpot = false;
            
            // Try 100 times to find a safe spot
            for(let i = 0; i < 100; i++) {
                // Random position strictly within the boundary box
                // We subtract btnWidth/Height to ensure the right/bottom edges don't overflow
                const availableWidth = rect.width - btnWidth;
                const availableHeight = rect.height - btnHeight;

                const randomX = rect.left + Math.random() * availableWidth;
                const randomY = rect.top + Math.random() * availableHeight;

                // Collision Detection
                // Check if this new box overlaps with the Yes button
                // Expand the Yes button box slightly (buffer) to ensure they don't touch
                const buffer = 20; 
                
                // Note: collision logic uses global viewport coordinates
                const noRight = randomX + btnWidth;
                const noBottom = randomY + btnHeight;
                
                const yesLeft = yesRect.left - buffer;
                const yesRight = yesRect.right + buffer;
                const yesTop = yesRect.top - buffer;
                const yesBottom = yesRect.bottom + buffer;

                const isOverlapping = !(
                    noRight < yesLeft || 
                    randomX > yesRight || 
                    noBottom < yesTop || 
                    randomY > yesBottom
                );

                if (!isOverlapping) {
                    bestX = randomX;
                    bestY = randomY;
                    foundSafeSpot = true;
                    break;
                }
            }

            // If we couldn't find a spot (e.g., Yes button is too huge), 
            // fallback to a corner of the boundary to ensure it's visible.
            if (!foundSafeSpot) {
                // Pick a random corner
                 const corners = [
                    {x: rect.left, y: rect.top},
                    {x: rect.right - btnWidth, y: rect.top},
                    {x: rect.left, y: rect.bottom - btnHeight},
                    {x: rect.right - btnWidth, y: rect.bottom - btnHeight}
                ];
                const corner = corners[Math.floor(Math.random() * corners.length)];
                bestX = corner.x;
                bestY = corner.y;
            }

            // Apply new position
            noBtn.style.left = bestX + 'px';
            noBtn.style.top = bestY + 'px';

            // Shrink 'No' button (only once)
            if (!hasShrunk) {
                noScale = 0.5;
                noBtn.style.transform = `scale(${noScale})`;
                hasShrunk = true;
            }

            // Grow 'Yes' button (only once)
            if (!hasGrown) {
                yesScale = 2;
                yesBtn.style.transform = `scale(${yesScale})`;
                hasGrown = true;
            }
        }

        // Add event listeners for 'No' button
        noBtn.addEventListener('mouseover', moveNoButton);
        noBtn.addEventListener('touchstart', (e) => {
            e.preventDefault(); // Prevent clicking on mobile
            moveNoButton();
        });
        noBtn.addEventListener('click', (e) => {
             e.preventDefault();
             moveNoButton();
        });

        // Add event listener for 'Yes' button
        yesBtn.addEventListener('click', () => {
            mainContent.style.display = 'none';
            successContent.style.display = 'flex';
            
            // Stop background hearts and start heavy rain
            clearInterval(heartInterval);
            createHeartRain();
        });

        // Background Hearts Animation
        function createHeart() {
            const heart = document.createElement('div');
            heart.classList.add('heart');
            heart.innerHTML = '❤️';
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = Math.random() * 3 + 3 + 's';
            document.getElementById('hearts-container').appendChild(heart);

            setTimeout(() => {
                heart.remove();
            }, 6000);
        }

        const heartInterval = setInterval(createHeart, 300);

        // Heavy Heart Rain effect for success
        function createHeartRain() {
            const heartCount = 100; // Much more hearts for "rain"
            
            for (let i = 0; i < heartCount; i++) {
                setTimeout(() => {
                    const heart = document.createElement('div');
                    heart.innerHTML = '❤️';
                    heart.style.position = 'fixed';
                    heart.style.left = Math.random() * 100 + 'vw';
                    heart.style.top = '-50px';
                    heart.style.fontSize = (Math.random() * 20 + 20) + 'px'; // Varied sizes
                    heart.style.color = '#ff4d4d'; // Just in case emoji color fails, though it won't
                    heart.style.transition = `top ${Math.random() * 2 + 3}s ease-in, transform 3s linear`;
                    heart.style.zIndex = '100';
                    document.body.appendChild(heart);

                    // Trigger the fall
                    setTimeout(() => {
                        heart.style.top = '110vh';
                        heart.style.transform = `rotate(${Math.random() * 360}deg)`;
                    }, 50);

                    // Clean up
                    setTimeout(() => {
                        heart.remove();
                    }, 6000);
                }, i * 50); // Stagger the creation for a rain effect
            }
            
            // Keep raining indefinitely
            setInterval(() => {
                 const heart = document.createElement('div');
                    heart.innerHTML = '❤️';
                    heart.style.position = 'fixed';
                    heart.style.left = Math.random() * 100 + 'vw';
                    heart.style.top = '-50px';
                    heart.style.fontSize = (Math.random() * 20 + 20) + 'px'; 
                    heart.style.transition = `top ${Math.random() * 2 + 3}s ease-in, transform 3s linear`;
                    heart.style.zIndex = '100';
                    document.body.appendChild(heart);

                    setTimeout(() => {
                        heart.style.top = '110vh';
                        heart.style.transform = `rotate(${Math.random() * 360}deg)`;
                    }, 50);

                    setTimeout(() => {
                        heart.remove();
                    }, 6000);
            }, 100);
        }
    </script>
</body>
</html>
